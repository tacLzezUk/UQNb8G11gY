steps:
  - label: ":page_facing_up: Build and Deploy Documentation"
    plugins:
      - JuliaCI/julia#v1:
          version: "1"
    command: |
      julia --project=docs -e '
        println("--- :julia: Instantiating project")
        using Pkg
        Pkg.develop(PackageSpec(path=pwd()))
        Pkg.instantiate()
        println("--- :julia: Building documentation")
        include("docs/make.jl")
      '
    agents:
      queue: "juliagpu"
      cuda: "*"
    env:
      DATADEPS_ALWAYS_ACCEPT: true
    if: build.message !~ /\[skip docs\]/ && !build.pull_request.draft
    timeout_in_minutes: 1000

env:
  JULIA_PKG_SERVER: "" # it often struggles with our large artifacts
  SECRET_DOCUMENTER_KEY: "e8HBtlxhrGysmgRz5t5s/KOTY4WLjWC+ISPBGNsmzj0JnHdxPD+TjuYmmDIR+I4/Q2s9g8CR3s6XcZtNr5e9h2rM2U52BS5m7WnMQEAHS6ylPexM4T7uZlS96enPmD3zWZQNNi2v8PuXvfOhZ2XJJjX76wJ3h+rvHVtpkGMXe4nsJPOG8K+Jo9VtYiaKXzhZRm14Lo+ju8jvjOnCO532jHf17c6cvHlVjBf54slGdVpEfniebVIhPFj+Mj4XCtQdvo3KggllwW8gEbfa8sfmluSFggzoNFoC8sM7x5xTHrzezO8TMg+eKmotCbHDfEIUqJlb8F6s/ztk+QS831JfMg==;U2FsdGVkX186kG7JtMdJI8duENmewnn+8p+ThCvjKODLXCWC4q9cDcTNh5WFk7i493EmvqrkTBk2ZPlRy1zNXgF18q8DYBbGLbLw7IVTfJTHZGbMZQp5YM+7UEg0Oo4j5SkczjaEMS8c8QOPRHYTkuAbXLfiGn09HWumfzyjUPwJ5aPnbFhAI7omHnrsmtoiCmzNemzsQmZRPmVqnUgcSTXxSlAaH/DXnMnmYTg9Ksep0RV0Anz14djg5bb7uAb2fI7vXdnkxYNyyLjfs9x9nbeouSZeSdeGqTidauAn4AOjkQdYGegs0I7zVlCDIPGU6+0iJXda5u9JCTquokOr8OHksx+74ZUQ13EaoBMWiVbJnY8MMcylMAFFo6iM62OoBbLdKqBgBW6TMpqLjlb7SdN6I7UDb5ac0kNxaJ6kaR61Ok//MknubnGUZtLnJXnH97oDzd0YUUzKbzMGT+plkJw9GCF9OcLnlgHvaip6UD+oycICENllk7ZN2Hymoi+CgBI6aCNCVWj62q4/FiRufVW1J6O2yyYa8sDP95hEgCmxlxWIFBm+kuXgbbB6R7gUb5ljSfedsIQYevEM0HCN3aBSrOWj5S37TcN+60LHKH1hRP7zx8khxgv7u/bAdcBHG6hkm4WljwVIY6RolRexnxqwu+OWRg05WwDc3BWdIyBYBgPM+FPJWbE5PBBs/zCEtDVyH0ynwSdo+Xbi64F0v+SLGeq7n/+XWZ98hYk8MOAj6jedH7iYJeNRQkmT/0CGjE5xGG9rGssnBkcdokygX8yJ8iJQ1zo3e7P6svDCoNBkV/veFKKUD7cprp4X/zBecWdhy4HxVZrABmm0YbG3JX+rJdJuxRgB1tJ01OfWV4Ejq/cHCncSsn5Wmye2E0eNH0bIY2bDjaQAMAF5O5LebwDgjArg7HgXEs0f3o5yZM/xu8/6TPK27RSKwro4pWzP4KOqB3zIgUpjPxstfawkXDk795ZY8BVQn9rOPnH0D1DDz3Rlw48DXtT9yXiZETthCJQSWwtKF6jssXGccY6NgScGdYGlGfEaNy/faUTNxiukEFaf58NNZzNARAGvn/u8mbzeAmy6Hx0lpwt73BSXGlOCtb6I6/AjIlYwmlaLzOMFm3tx1gfCIkT+TL6C5ARpj8H9iqrd1sjZsAD/w+NSICRiV9+VwNpoBbu4Y+8pthMPXhLdQRXr66sQ2lQaubWfrZ/BiqMC/cQGZF4xzwtJoIvX8cEFiW0jzByScDYaAUHFcfzQM5qMBuo904nDrJY/dUpbEZFI6i1tA+gjXGjL4WnXl+9UFvTPe7jArTTdhkEwmBxTaOR+BOg2Y1WD25K5/mzGGqkoLxbfIVMCFMykOJpAGIjTNm6dIIWUTe+uomPsmDuVDDPbl6w7tk8TqLOP+Ab8hsYzMlllkzy3bfgqRyWGrVan9lpkpr20gP4LDxvqUuagUMlDxN/VIBv4pT3DpOnVBt68GBwUu2bkyFIvnZ57mI/sHB8ARy9fO3JttXgFwJQGUlSPFnABX40hZicbeeQluNvrgMQDKqG/qTAyzAkNMpq2MxOgUwhlFLuk4xWIC1GmvgL68EQFtw/j9RjcrpIW/6+1WVPgIdQFOkgz0/fS5X+W/AzpRUJSb18NMwx+xjPLAPll6n+49TQXXtGHV07K3vKbTrgzohrmnehz6LBDAwSorlnequm1LnoHGVmYQTtWfycX6C4pPO6XrUpCC7pm6HifhiNxafebtGE+Gi4QvS0Z+jBFrZlWQsPfQ1mf6966hIrUEDDoxFOzLJB3S3DoTutAbsYOJGLQNhsa5XBwY7f8gy++vrXZH9tFgPBDUn5tHd/CVy+ivW+BfkVqdCibXwv9c02R7UJdP9G8ttN7pJl2ByEFbVAH/reKvk+5hl1KFCunMAqYbqGjwrLHnhXgx7Cp3tWz1D+Z0uGqX7RAVhKfgpb1CtA7DJ9kegtu4Gos01wnLGxs6yYxklHuryK3QU8O1lKqwFDE7UgG2qsIj8BCqsTxVxT97sUee0+DerIVPio8Q/lcIdI5Lyyed9PtNs484+VqVX7+QOA/2dJNdYCK4xqgoL++TS9Y4+YlnaswqExHP/I6eFnsrlTYQow40qDYj7PVGz7r5nYpIiRITtLV5FpYvtnxBTf26GE/gMrxooZ8sydlmCnSFZNkEO1qq7JneITTQOf/rornPFtvp2gRk1w4uieP+/or3+tTvLN/LUvoFb5DK2JugVtP9CuvSaObCA/9VSd/Zkq1ltZDGzG4n7DcEsTu/grVGFtR9dmExZOoZcau2SsAIm+3ZGSC+wuS9zRHD1e5205cH++laaOXEC0XZUucX027pDi0HWG7nJad8BEgbsb2W7mzXpQTLleAepg5jAIJn3HHCijEwREHfNARhZp7U9znUannjdkjjVI9LthTmapa0FvwyOcCF7cKd9UkrkPu1AdSNqs9a9fOtrwN/bSksHmMFpvEd43klz/aGdcZeFVd5pDBYIYMAwR/arNBdWRqgGulpm22tQ0NcN7Yh+YN2t37xezcBEnmXjSwcZGVkCFjkCIUVG6d2a5edK9nB3KP2Dz8Vx8CcVqsLt2ncdXxIGZjq3JHg6foeFLI4cDdc4TUen6VTysasxWBf6MLpr4q/HHSsCAmFPdNl8WP4IHu5x/dW2Mr3BcUND8iGG7/SoEKff3YG13CRxi2g68VY7sA99KAu3VB7zXOWFlEwZ0URPm9/hnW+9eu+redogYYa+8+snjF+4oouip2AD1MlRtYplRixHtcUdh5BBi1nzAjiB/SNH+cVYBhg82h3jeoLgvvJf6hDHUjB+i1z4Ct05iQOiJirQ9p+KON/Ms6DLdwH+IhCdvjI6QtWpfsoKUz+I0BbpBhW5Eh0otQt6VFwGczETzHNzHhoLHg+lF5XSqx94KxIMFwF+Q/piZyKKy2PGuOt4bIM7V6/4Cr27opI/pc7QiWxEjW4McsJTYRaXheIm6vzoAw81H5w8+IXL0c2YnLhN6PhKe1hyoAeIVBGYt1vJYLBsBF9G4v7+WdNQNHXvENCYfwOrgYGgRdF2/584ScQYbkk72W4tiq5jAdi4j4aIDfUQH5ys80OBMdiZg74kDj3Y40qQ4xLJ4vkzRL7eyVnNNJeRAjdYpGRupQzwHonbYVbxTW6+vVgi61smOu7rHvWqngEXS8EOCo4IS7w0vsk6H97crFG1mUk9gvwNFkRXbE9J5P9sIP5KJRnas/5YwpmGeDZPjdmygoCHnkjmoRBejvk6cikWRAHgURgdwGzlzE7auS694l8Nmu7bOGsbn2bCLG2hbET3+OTnwVqArKQNnxwY7oFqfzkEdGwwVsM6Au+KCQIwaI1cG/4Z2aNbo/tAyK5utYRdr1a0mY1pwNJ3JyUBBRuMDoL6nGdNSWHksep9g/X/2zoZzG6rPTDPeDZpGCAXjxITspr4jBeCUoJ/7/oDrbLcO3uMbQz8xd0kNtmA9BzQZuLzU8IgBbvi3J+/tgVhhnP7pfU63IrbJ2TNEhbMK+/h2aD8+UXOY6E+Rz//knkPZtRgjOMMW1nRCwAKA7mYLjYesW5tB6tC5mO4sIM3iM3swfXwX6Ckym/rJ3fx6fgSaBTrlTMzKxIRbyQStq4tdUImBWNsWY5Kzm5oWwGPZSEaEsaFhQktkFVcTgIEE/wsx1Flg11H1rwQcUuySzpuKth4gtn4d/4qEe3beTyoH6RYAE2vy9tC8jNGpqvJaxX1Df9wErlUC9jowW1AX4lNzsKhaJOtRYKVy7OvyRE3rlLCiiiC7kNdgxLpP4A/CikdFZbi9mI4sKiaZ4h6TlsaDpAPwjRctM7OIPisKS0Hi1krRrAU9H6/82GB1FlRWfrI98zEq6no97uqpeumDZK+oxQTGUZuq8A86Ak36qX1iIs2okacbxl+SbFbd/+nW1dxwVBEQN9wzM4wuZiFuTc5lh/4d4/2S4RkSuQuD93oG18rvfTILkJGodMq61pZE5Er+WeQG5y0TRskdZfpSvbwOCc82W4Z8kiYM4lt6XSwUeF7GNQTq8O4S0bUuyyTn1yWM3xg++Drj6kKymYHOpixo98jUoeStdxVnPBKG28m/i+OjAJac6bE465QuVbNASDbGoWObzanKlRxFJGULVtpCBjq558mJ+i17ajP5tJgHNxapnOiTN0xFJ67nWOfdKk6q3R1mElsOOspNPY25TKlH5mqOZgZUwTw3iokI2R2haueNzjMDbro9CXACMyQr3WTpuJ2XrXw7cUVcQlvr91W9qhooJidW1bFGNKcrXNBDiNZZWo4DQvtqyt1OS2ssmyJsWO6/33APgaZ9I2GDhWB1BCGCyYjHJn+G0wH38fe8p719qcGF5tLbEHAo6GF5a7uyg+q1pvx5FhloTmAqABk+8voBJ2rEMD3bQXn5r"